---
layout: default
---
{% if page.image %}
<div class="featured-image-container">
  <img src="{{ page.image | relative_url }}" alt="{{ page.title }}" class="featured-image">
</div>
{% endif %}

<article class="blog-post">
  <h1>{{ page.title }}</h1>
  <p class="meta">{{ page.date | date: "%B %-d, %Y" }}</p>

  {{ content }}

  <!-- Voting section -->
  <div class="vote-section mt-4">
    <div class="vote-buttons">
      <button onclick="handleVote('up')" class="vote-btn upvote">
        <i class="fas fa-arrow-up"></i>
        <span class="vote-count upvote-count">0</span>
      </button>
      <button onclick="handleVote('down')" class="vote-btn downvote">
        <i class="fas fa-arrow-down"></i>
        <span class="vote-count downvote-count">0</span>
      </button>
    </div>
  </div>

  <!-- Social sharing section -->
  <div class="share-section mt-4">
    <h5 class="share-title">Share this post with your friends!!</h5>
    <div class="share-buttons">
      <a href="#" onclick="shareOnTwitter(this); return false;" class="share-btn" data-platform="twitter">
        <i class="fab fa-twitter"></i> Twitter
        <span class="share-count">0</span>
      </a>
      
      <a href="#" onclick="shareOnReddit(this); return false;" class="share-btn" data-platform="reddit">
        <i class="fab fa-reddit"></i> Reddit
        <span class="share-count">0</span>
      </a>
      
      <a href="#" onclick="shareOnLinkedIn(this); return false;" class="share-btn" data-platform="linkedin">
        <i class="fab fa-linkedin"></i> LinkedIn
        <span class="share-count">0</span>
      </a>
      
      <a href="#" onclick="shareOnFacebook(this); return false;" class="share-btn" data-platform="facebook">
        <i class="fab fa-facebook"></i> Facebook
        <span class="share-count">0</span>
      </a>
    </div>
  </div>

  <!-- Add Disqus comments section -->
  {% if page.comments != false %}
  <div class="comments-section mt-5">
    <h5 class="comments-title mb-4">Comments</h5>
    <script src="https://utteranc.es/client.js"
            repo="goyalpramod/goyalpramod.github.io"
            issue-term="pathname"
            label="ðŸ’¬ comments"
            theme="github-light"
            crossorigin="anonymous"
            async>
    </script>
  </div>
  {% endif %}
</article>

<!-- Add Font Awesome for social icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">

<script>
const pageUrl = encodeURIComponent(window.location.href);
const pageTitle = encodeURIComponent('{{ page.title }}');
const GITHUB_REPO = 'goyalpramod/goyalpramod.github.io';
const GITHUB_TOKEN = 'github_pat_YOUR_TOKEN'; // You'll need to set this up

// Function to get or create metrics issue
async function getOrCreateMetricsIssue() {
  const issueTitle = `Metrics: ${window.location.pathname}`;
  const searchUrl = `https://api.github.com/search/issues?q=repo:${GITHUB_REPO}+"${issueTitle}"`;
  
  try {
    const response = await fetch(searchUrl, {
      headers: {
        'Authorization': `token ${GITHUB_TOKEN}`,
        'Accept': 'application/vnd.github.v3+json'
      }
    });
    const data = await response.json();
    
    if (data.items && data.items.length > 0) {
      return data.items[0];
    } else {
      // Create new issue if none exists
      const createResponse = await fetch(`https://api.github.com/repos/${GITHUB_REPO}/issues`, {
        method: 'POST',
        headers: {
          'Authorization': `token ${GITHUB_TOKEN}`,
          'Accept': 'application/vnd.github.v3+json'
        },
        body: JSON.stringify({
          title: issueTitle,
          body: JSON.stringify({
            upvotes: 0,
            downvotes: 0,
            shares: {
              twitter: 0,
              reddit: 0,
              linkedin: 0,
              facebook: 0
            }
          })
        })
      });
      return await createResponse.json();
    }
  } catch (error) {
    console.error('Error accessing GitHub API:', error);
    return null;
  }
}

// Function to update metrics
async function updateMetrics(metrics) {
  const issue = await getOrCreateMetricsIssue();
  if (!issue) return;
  
  try {
    await fetch(`https://api.github.com/repos/${GITHUB_REPO}/issues/${issue.number}`, {
      method: 'PATCH',
      headers: {
        'Authorization': `token ${GITHUB_TOKEN}`,
        'Accept': 'application/vnd.github.v3+json'
      },
      body: JSON.stringify({
        body: JSON.stringify(metrics)
      })
    });
  } catch (error) {
    console.error('Error updating metrics:', error);
  }
}

// Share functions
async function shareOnPlatform(element, platform, url) {
  const issue = await getOrCreateMetricsIssue();
  if (!issue) return;
  
  const metrics = JSON.parse(issue.body);
  metrics.shares[platform]++;
  
  await updateMetrics(metrics);
  element.querySelector('.share-count').textContent = metrics.shares[platform];
  
  window.open(url, '_blank', 'noopener,noreferrer');
}

function shareOnTwitter(element) {
  shareOnPlatform(element, 'twitter', `https://twitter.com/intent/tweet?url=${pageUrl}&text=${pageTitle}`);
}

// Similar updates for other share functions...

// Updated voting functionality
async function handleVote(type) {
  const issue = await getOrCreateMetricsIssue();
  if (!issue) return;
  
  const metrics = JSON.parse(issue.body);
  const path = window.location.pathname;
  const storageKeyPrevVote = `prev_vote_${path}`;
  const prevVote = localStorage.getItem(storageKeyPrevVote);
  
  if (prevVote === type) {
    // Remove vote
    metrics[`${type}votes`]--;
    localStorage.removeItem(storageKeyPrevVote);
    removeVotedClass(type);
  } else {
    // Change vote
    if (prevVote) {
      metrics[`${prevVote}votes`]--;
      removeVotedClass(prevVote);
    }
    metrics[`${type}votes`]++;
    localStorage.setItem(storageKeyPrevVote, type);
    addVotedClass(type);
  }
  
  await updateMetrics(metrics);
  updateVoteDisplay('up', metrics.upvotes);
  updateVoteDisplay('down', metrics.downvotes);
}

// Load initial metrics
document.addEventListener('DOMContentLoaded', async function() {
  const issue = await getOrCreateMetricsIssue();
  if (!issue) return;
  
  const metrics = JSON.parse(issue.body);
  
  // Update vote counts
  updateVoteDisplay('up', metrics.upvotes);
  updateVoteDisplay('down', metrics.downvotes);
  
  // Update share counts
  Object.entries(metrics.shares).forEach(([platform, count]) => {
    const button = document.querySelector(`[data-platform="${platform}"] .share-count`);
    if (button) button.textContent = count;
  });
  
  // Restore user's previous vote if any
  const prevVote = localStorage.getItem(`prev_vote_${window.location.pathname}`);
  if (prevVote) {
    addVotedClass(prevVote);
  }
});
</script>

<style>
.share-section {
  border-top: 1px solid #eee;
  padding-top: 1.5rem;
  margin-top: 2rem;
}

.share-buttons {
  display: flex;
  flex-direction: row;
  gap: 0.5rem;
  flex-wrap: wrap;
}

.share-btn {
  display: flex;
  align-items: center;
  text-decoration: none;
  color: #586069;
  padding: 0.35rem 0.75rem;
  border: 1px solid #e1e4e8;
  border-radius: 4px;
  font-size: 0.9rem;
  transition: all 0.2s ease;
  min-width: 120px;
}

.share-btn:hover {
  background-color: #f6f8fa;
  text-decoration: none;
  transform: translateX(3px);
  color: #0366d6;
}

.share-btn i {
  margin-right: 0.5rem;
  width: 16px;
}

.share-count {
  margin-left: auto;
  background: rgba(0,0,0,0.05);
  padding: 0.1rem 0.4rem;
  border-radius: 1rem;
  font-size: 0.8rem;
  color: #586069;
}

.vote-section {
  margin: 2rem 0;
  display: flex;
  justify-content: flex-start;
}

.vote-buttons {
  display: flex;
  gap: 0.75rem;
  align-items: center;
  background: #f8f9fa;
  padding: 0.5rem 1rem;
  border-radius: 8px;
  border: 1px solid #e1e4e8;
}

.vote-btn {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  padding: 0.4rem 0.8rem;
  border: 1px solid transparent;
  border-radius: 6px;
  background: white;
  cursor: pointer;
  transition: all 0.2s ease;
  box-shadow: 0 1px 2px rgba(0,0,0,0.05);
}

.vote-btn:hover:not(.disabled) {
  background-color: #f6f8fa;
  transform: translateY(-1px);
  box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

.upvote {
  color: #28a745;
}

.upvote:hover:not(.disabled) {
  background-color: #f0fff4;
  border-color: #28a745;
}

.downvote {
  color: #dc3545;
}

.downvote:hover:not(.disabled) {
  background-color: #fff5f5;
  border-color: #dc3545;
}

.vote-count {
  font-weight: 600;
  font-size: 0.9rem;
  min-width: 1.5rem;
  text-align: center;
}

.voted {
  background-color: #f6f8fa;
  border-color: currentColor;
}

.disabled {
  opacity: 0.6;
  cursor: not-allowed;
  box-shadow: none;
}

.disabled:hover {
  transform: none;
  box-shadow: none;
}

/* Make the voting section and share buttons look cohesive */
.vote-section + .share-section {
  margin-top: 1.5rem;
  padding-top: 1.5rem;
  border-top: 1px solid #eee;
}

.share-title {
  margin-bottom: 1rem;
  color: #24292e;
  font-size: 1rem;
  font-weight: 600;
}

/* Add styles for comments section */
.comments-section {
  border-top: 1px solid #eee;
  padding-top: 2rem;
  margin-top: 2rem;
}

.comments-title {
  color: #24292e;
  font-size: 1.1rem;
  font-weight: 600;
}
</style>
